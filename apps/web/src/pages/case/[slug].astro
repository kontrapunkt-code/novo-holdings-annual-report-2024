---
import CaseModules from "@/components/astro/CaseModules.astro";
import HeroCase from "@/components/astro/HeroCase.astro";
import PageLayout from "@/layouts/PageLayout.astro";
import { casesResult } from "@/scripts/queries";
import type { GetStaticPathsResult, InferGetStaticPropsType } from "astro";

export const getStaticPaths = async () => {
	const staticPaths = (await casesResult).map((page) => ({
		params: {
			slug: page.slug?.split("/").pop() ?? "404",
		},
		props: {
			page,
		},
	}));

	return staticPaths satisfies GetStaticPathsResult;
};

export type Props = InferGetStaticPropsType<typeof getStaticPaths>;

const { page } = Astro.props;
---

<PageLayout title={page.title ?? undefined}>
	<HeroCase {...page} />
	<CaseModules modules={page.modules} />
</PageLayout>
